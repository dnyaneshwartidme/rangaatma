{% extends 'ms_admin/base.html' %} {% block title %}We Are Hiring{% endblock %}
{% block content %}

<section>
  <h4 class="text-primary my-3 text-center fw-bold">We Are Hiring</h4>

  <!-- Add Job Button -->
  <div class="text-end mb-3">
    <button
      class="btn btn-primary btn-sm"
      data-bs-toggle="modal"
      data-bs-target="#addJobModal"
    >
      <i class="bi bi-plus-circle me-1"></i> Add Job
    </button>
  </div>

  <!-- Jobs Loop -->
  <div class="accordion" id="jobAccordion">
    {% for job in jobs %}
    <div class="accordion-item border rounded mb-4">
      <h2 class="accordion-header" id="heading{{ job.id }}">
        <button
          class="accordion-button collapsed fw-bold flex-column text-start px-3"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#collapse{{ job.id }}"
          aria-expanded="false"
          aria-controls="collapse{{ job.id }}"
          style="background-color: #e6f0ff"
        >
          <div
            class="d-flex flex-column flex-sm-row w-100 align-items-start align-items-sm-center justify-content-between"
          >
            <div class="d-flex align-items-center gap-2">
              <i class="bi bi-gear-fill text-primary fs-3"></i>
              <h4 class="mb-0">{{ job.job_title }}</h4>
            </div>
          </div>

          <div
            class="w-100 d-flex flex-column flex-md-row justify-content-start flex-wrap gap-2 gap-md-4 text-secondary ps-4 pt-2"
          >
            <div><strong>Qualification:</strong> {{ job.qualification }}</div>
            <div><strong>Experience:</strong> {{ job.experience }}</div>
          </div>
        </button>
      </h2>

      <div
        id="collapse{{ job.id }}"
        class="accordion-collapse collapse"
        aria-labelledby="heading{{ job.id }}"
        data-bs-parent="#jobAccordion"
      >
        <div class="accordion-body">
          <p class="fw-bold mb-1">Job Description</p>
          <p>{{ job.job_description }}</p>

          <p class="fw-bold mb-1">Roles and Responsibilities</p>
          <p>{{ job.responsibilities }}</p>

          <p class="fw-bold mb-1">Key Skills</p>
          <p>{{ job.key_skills }}</p>

          <div class="d-flex justify-content-end gap-2 mt-3">
            <button
              class="btn btn-warning btn-sm"
              data-bs-toggle="modal"
              data-bs-target="#editModal{{ job.id }}"
            >
              Edit
            </button>
            <button
              class="btn btn-danger btn-sm"
              data-bs-toggle="modal"
              data-bs-target="#deleteModal{{ job.id }}"
            >
              Delete
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Edit Modal -->
    <div class="modal fade" id="editModal{{ job.id }}" tabindex="-1">
      <div class="modal-dialog modal-lg">
        <form
          method="POST"
          action="{{ url_for('edit_we_are_hiring', id=job.id) }}"
          class="modal-content"
        >
          <div class="modal-header">
            <h5 class="modal-title">Edit Job</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
            ></button>
          </div>
          <div class="modal-body row g-3">
            <div class="col-md-6">
              <label class="form-label">Job Title</label>
              <input
                type="text"
                class="form-control"
                name="job_title"
                value="{{ job.job_title }}"
                required
              />
            </div>
            <div class="col-md-6">
              <label class="form-label">Qualification</label>
              <input
                type="text"
                class="form-control"
                name="qualification"
                value="{{ job.qualification }}"
                required
              />
            </div>
            <div class="col-md-6">
              <label class="form-label">Experience</label>
              <input
                type="text"
                class="form-control"
                name="experience"
                value="{{ job.experience }}"
                required
              />
            </div>
            <div class="col-12">
              <label class="form-label">Job Description</label>
              <textarea class="form-control" name="job_description" rows="2">
{{ job.job_description }}</textarea
              >
            </div>
            <div class="col-12">
              <label class="form-label">Responsibilities</label>
              <textarea class="form-control" name="responsibilities" rows="2">
{{ job.responsibilities }}</textarea
              >
            </div>
            <div class="col-12">
              <label class="form-label">Key Skills</label>
              <textarea class="form-control" name="key_skills" rows="2">
{{ job.key_skills }}</textarea
              >
            </div>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary btn-sm"
              data-bs-dismiss="modal"
            >
              Cancel
            </button>
            <button type="submit" class="btn btn-success btn-sm">Update</button>
          </div>
        </form>
      </div>
    </div>

    <!-- Delete Modal -->
    <div class="modal fade" id="deleteModal{{ job.id }}" tabindex="-1">
      <div class="modal-dialog">
        <form
          method="POST"
          action="{{ url_for('delete_we_are_hiring', id=job.id) }}"
          class="modal-content"
        >
          <div class="modal-header">
            <h5 class="modal-title">Confirm Delete</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
            ></button>
          </div>
          <div class="modal-body">
            Are you sure you want to delete this job?
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary btn-sm"
              data-bs-dismiss="modal"
            >
              Cancel
            </button>
            <button type="submit" class="btn btn-danger btn-sm">Delete</button>
          </div>
        </form>
      </div>
    </div>
    {% endfor %}
  </div>
</section>

<!-- Add Job Modal -->
<div class="modal fade" id="addJobModal" tabindex="-1">
  <div class="modal-dialog modal-lg">
    <form
      method="POST"
      action="{{ url_for('add_we_are_hiring') }}"
      class="modal-content"
    >
      <div class="modal-header">
        <h5 class="modal-title">Add New Job</h5>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
        ></button>
      </div>
      <div class="modal-body row g-3">
        <div class="col-md-6">
          <label class="form-label">Job Title</label>
          <input type="text" class="form-control" name="job_title" required />
        </div>
        <div class="col-md-6">
          <label class="form-label">Qualification</label>
          <input
            type="text"
            class="form-control"
            name="qualification"
            required
          />
        </div>
        <div class="col-md-6">
          <label class="form-label">Experience</label>
          <input type="text" class="form-control" name="experience" required />
        </div>
        <div class="col-12">
          <label class="form-label">Job Description</label>
          <textarea
            class="form-control"
            name="job_description"
            rows="2"
          ></textarea>
        </div>
        <div class="col-12">
          <label class="form-label">Responsibilities</label>
          <textarea
            class="form-control"
            name="responsibilities"
            rows="2"
          ></textarea>
        </div>
        <div class="col-12">
          <label class="form-label">Key Skills</label>
          <textarea class="form-control" name="key_skills" rows="2"></textarea>
        </div>
      </div>
      <div class="modal-footer">
        <button
          type="button"
          class="btn btn-secondary btn-sm"
          data-bs-dismiss="modal"
        >
          Cancel
        </button>
        <button type="submit" class="btn btn-success btn-sm">Save</button>
      </div>
    </form>
  </div>
</div>

{% endblock %}
